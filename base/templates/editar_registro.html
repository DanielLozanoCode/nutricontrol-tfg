<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Editar registro</title>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const input = document.getElementById("id_alimento_nombre");
            const datalist = document.getElementById("sugerencias");

            input.addEventListener("input", async function() {
                const q = encodeURIComponent(input.value);
                const response = await fetch(`/sugerencias-alimentos/?q=${q}`);
                const datos = await response.json();

                datalist.innerHTML = "";
                datos.forEach(nombre => {
                    const option = document.createElement("option");
                    option.value = nombre;
                    datalist.appendChild(option);
                });
            });
        });
    </script>
</head>
<body>
    <h2>Editar registro de alimentación</h2>

    {% if messages %}
        {% for message in messages %}
            <p style="color: green;">{{ message }}</p>
        {% endfor %}
    {% endif %}

    <form method="POST">
        {% csrf_token %}
        <input list="sugerencias"
               id="id_alimento_nombre"
               name="alimento_nombre"
               placeholder="Escribe un alimento..."
               value="{{ form.alimento_nombre.value }}"
               required>
        <datalist id="sugerencias"></datalist>

        {{ form.cantidad }}

        <button type="submit">Guardar cambios</button>
    </form>

    <p><a href="{% url 'lista_registros' %}">← Volver a mis registros</a></p>
</body>
</html>
